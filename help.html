
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>=^.^=</title>
</head>
<body>
<h1>Select a zip file to extract</h1>

select a zip file<br>
<input id="select" type="file" accept=".zip"><br>

<script src="ZipLoader.js"></script>
<script>

const $select = document.getElementById( 'select' );

$select.addEventListener( 'change', function ( event ) {

	const file0 = event.target.files[ 0 ];
	console.log(file0);

	ZipLoader.unzip( file0 ).then( function ( unziped ) {
		console.log(unziped.files);

		Object.keys( unziped.files ).forEach( ( fileName ) => {

			if ( unziped.files[ fileName ].buffer.length === 0 ) return;

			const $div = document.createElement( 'div' );
			const $a = document.createElement( 'a' );
			$a.textContent = fileName;
			$a.href = unziped.extractAsBlobUrl( fileName, guessFileType( fileName ) );
			$div.appendChild( $a );
			document.body.appendChild( $div );

		} );

	} );

} );

function guessFileType( fileName ) {

	return /\.jpeg$/i.test( fileName ) ? 'image/jpeg' :
	       /\.png$/i  .test( fileName ) ? 'image/png'  :
	       /\.gif$/i  .test( fileName ) ? 'image/gif'  :
	       /\.txt$/i  .test( fileName ) ? 'text/plain' :
	       /\.js$/i   .test( fileName ) ? 'text/plain' :
	       /\.json$/i .test( fileName ) ? 'text/plain' :
	       /\.html$/i .test( fileName ) ? 'text/plain' :
	       /\.css$/i  .test( fileName ) ? 'text/plain' :
	       /\.svg$/i  .test( fileName ) ? 'text/plain' :
	       'application/octet-stream';

}

</script>

</body>
</html>
